export interface Vulnerability {
  id: string;
  packageName: string;
  packageVersion: string;
  severity: 'critical' | 'high' | 'medium' | 'low';
  title: string;
  description: string;
  cveId?: string;
  cvssScore?: number;
  cvssVector?: string;
  patchedVersions?: string[];
  vulnerableVersions?: string[];
  firstPatchedVersion?: string;
  publishedDate?: string;
  lastModifiedDate?: string;
  source: 'osv' | 'snyk' | 'npm-audit' | 'github';
  references?: string[];
}

export interface ScanResult {
  vulnerabilities: Vulnerability[];
  supplyChainThreats: SupplyChainThreat[];
  totalPackages: number;
  vulnerablePackages: number;
  criticalCount: number;
  highCount: number;
  mediumCount: number;
  lowCount: number;
  supplyChainCriticalCount: number;
  supplyChainHighCount: number;
  supplyChainMediumCount: number;
  supplyChainLowCount: number;
  scanDuration: number;
  scannedAt: Date;
}

export interface Dependency {
  name: string;
  version: string;
  type: 'dependencies' | 'devDependencies' | 'peerDependencies' | 'optionalDependencies';
  resolved?: string;
  integrity?: string;
  dev?: boolean;
  optional?: boolean;
  bundled?: boolean;
}

export interface SupplyChainThreat {
  type: 'typosquatting' | 'malicious-script' | 'compromised-maintainer' | 'suspicious-activity';
  packageName: string;
  severity: 'critical' | 'high' | 'medium' | 'low';
  description: string;
  evidence: string[];
  recommendations: string[];
  detectedAt: Date;
}

export interface UpgradePath {
  packageName: string;
  currentVersion: string;
  targetVersion: string;
  isBreaking: boolean;
  fixedVulnerabilities: string[];
  changelogUrl?: string;
  confidence: 'high' | 'medium' | 'low';
  riskScore: number;
}
